//код программы Text-to-Speech

str sayBefore = "Local tume.";
str textHours = "Hours";
str textMinutes = "Minutes";
str textSeconds = "Seconds";
str sayAfter = "Good Afternoon!";

str sayBeforeRu = "Местное время.";
str textHoursRu = "Часов";
str textMinutesRu = "Минут";
str textSecondsRu = "Секунд";
str sayAfterRu = "Добрый день!";

when listPhrase.BeforePicking do {
  listPhrase.Elements = Phrases;
}

str Prases.makealist = "Время обедать!", "Время вставать!", "Время спать!";

when listPhrase.AfterPicking do {
  listPhrase.Elements = listPhrases.Selection;
}

when btnSetDefault.Click do {
  textSayBefore.Text = sayBefore;
  textHoursWord.Text = textHours;
  textMinutesWord.Text = textMinutes;
  textSecondsWord.Text = textSeconds;
  textSayAfter.Text = sayAfter;
  textTimeHours.Text = "12";
  listPhrase.Text = "Время обедать!";
  if chbRu.Checked then {
    textSayBefore.Text = sayBeforeRu;
    textHoursWord.Text = textHoursRu;
    textMinutesWord.Text = textMinutesRu;
    textSecondsWord.Text = textSecondsRu;
    textSayAfter.Text = sayAfterRu;
  }
}

when Screen1.initialize do {
  Clock2.TimerInterval = textInterval.Text * 1000;
  chbHours.Checked = false;
  chbMinutes.Checked = true;
  chbSeconds.Checked = true;
  Clock2.TimerEnabled = false;
  ScreenPhone1.Visible = true;
  ScreenPhone2.Visible = false;
  ScreenPhone3.Visible = false;
  textSayBefore.Text = sayBefore;
  textHoursWord.Text = textHours;
  textMinutesWord.Text = textMinutes;
  textSecondsWord.Text = textSeconds;
  textSayAfter.Text = sayAfter;
  textTimeHours.Text = "12";
  listPhrase.Text = "Время обедать!";
  Screen1.Title = "SayTime v1.0";
  if chbRu.Checked then {
    textSayBefore.Text = sayBeforeRu;
    textHoursWord.Text = textHoursRu;
    textMinutesWord.Text = textMinutesRu;
    textSecondsWord.Text = textSecondsRu;
    textSayAfter.Text = sayAfterRu;
  }
}

when Clock1.Timer do {
  hours.Text = Clock1.Hour(call Clock1.now);
  minutes.Text = Clock1.Minute(call Clock1.now);
  seconds.Text = Clock1.Second(call Clock1.now);
}

when btnSayNow.Click do {
  call sayTime();
}

when Clock2.Timer do {
  call sayTime();
}

when btnStart.Click do {
  Clock2.Timerinterval = textInterval.Text * 1000;
  Clock2.TimerEnabled = true;
}

when btnSilent.Click do {
  Clock2.TimerEnabled = false;
}

when Settings.Click do {
  ScreenPhone1.Visible = false;
  ScreenPhone2.Visible = true;
  Screen1.Title = "Settings";
}

when Home.Click do {
  ScreenPhone1.Visible = true;
  ScreenPhone2.Visible = false;
  Screen1.Title = "SayTimer v1.0";
}

when AdditionalSettings.Click do {
  ScreenPhone2.Visible = false;
  ScreenPhone3.Visible = true;
  Screen1.Title = "AdditionalSettings";
}

when BacktoSettings.Click do {
  ScreenPhone2.Visible = true;
  ScreenPhone3.Visible = false;
  Screen1.Title = "Settings";
}

str SayMessage = "";
str SayHours = "";
str SayMinutes = "";
str SaySeconds = "";

procedure sayTime() do {
  if (chbHours.Checked) then 
    SayHours = hours.Text + textHoursWord.Text;
  else
    SayHours = "";
    
    if (chbMinutes.Checked) then 
    SayMinutes += minutes.Text + textMinutesWord.Text;
  else
    SayMinutes += "";
    
    if (chbSeconds.Checked) then 
    SaySeconds += seconds.Text + textSecondsWord.Text;
  else
    SaySeconds += "";
    
    SayMessage += textSayBefore.Text + SayHours + SayMinutes + SaySeconds;
    if (textTimeHours.Text = Clock1.Hour(call Clock1.Now) then
      SayMessage += listPhrase.Text;
    SayMessage += textSayAfter.Text;
    
    call TextToSpeech1.Speak(SayMessage);
}
